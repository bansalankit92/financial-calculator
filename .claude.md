# Financial Calculator - Claude Code Documentation

This document helps Claude understand the codebase structure without extensive exploration.

## Project Overview
Next.js 15 financial calculator app with SIP, EMI, Tax, and Salary calculators for Indian users.

## Tech Stack
- **Framework**: Next.js 15 (App Router)
- **Language**: TypeScript
- **Styling**: Tailwind CSS
- **UI Components**: Headless UI, Heroicons
- **Animation**: Framer Motion
- **Charts**: Recharts

## Directory Structure

```
src/
├── app/                          # Next.js App Router pages
│   ├── layout.tsx               # Root layout with fonts, analytics
│   ├── page.tsx                 # Homepage (uses HomeContent component)
│   ├── sip/                     # SIP calculator routes
│   ├── step-up-sip/             # Step-Up SIP calculator
│   ├── emi/                     # EMI calculator routes
│   ├── salary-calculator/       # Salary calculator
│   ├── income-tax-calculator/   # Tax calculators
│   ├── new-regime-income-tax-calculator/
│   ├── old-regime-income-tax-calculator/
│   └── old-vs-new-regime-income-tax-calculator/
│
├── components/
│   ├── AppLayout.tsx            # Main app wrapper (Navbar + Main + Footer)
│   ├── Navbar.tsx               # Top navigation with hamburger menu
│   ├── Footer.tsx               # Footer with links
│   ├── HomeContent.tsx          # Homepage calculator cards
│   ├── Sidebar.tsx              # (Legacy - not currently used)
│   │
│   └── calculators/             # Calculator components
│       ├── SIPCalculator.tsx
│       ├── StepUpSIPCalculator.tsx
│       ├── StepUpForm.tsx
│       ├── StepUpSummary.tsx
│       ├── StepUpBreakdownTable.tsx
│       ├── EmiForm.tsx
│       ├── EmiSummary.tsx
│       ├── EmiBreakupTable.tsx
│       ├── WealthTable.tsx
│       └── ...
│
├── constants/
│   └── routes.ts                # Centralized route definitions (ROUTES object)
│
├── hooks/
│   ├── useQueryParams.ts        # URL query parameter management
│   └── useDebounce.ts          # Debounce hook for inputs
│
├── lib/
│   ├── calculations.ts          # All calculation logic
│   └── utils.ts                 # Utility functions (cn for classnames)
│
└── types/
    └── calculator.ts            # TypeScript types

```

## Key Files & Patterns

### Routes (src/constants/routes.ts)
Central source of truth for all routes. Always use `ROUTES.*` constants instead of hardcoded paths.

```typescript
export const ROUTES = {
  HOME: '/',
  SIP: '/sip',
  STEP_UP_SIP: '/step-up-sip',
  EMI: '/emi',
  SALARY: '/salary-calculator',
  NEW_TAX_REGIME_2025_26: '/new-regime-income-tax-calculator/2025-26',
  OLD_TAX_REGIME: '/old-regime-income-tax-calculator',
  OLD_VS_NEW_REGIME: '/old-vs-new-regime-income-tax-calculator',
  CONTACT: '/contact',
  // ... more routes
}
```

### Navigation Structure

**Navbar** (`src/components/Navbar.tsx`):
- Sticky header with hamburger menu
- Dropdown uses Headless UI Menu component
- Mobile-first: hamburger only (no desktop horizontal nav)
- Add new calculators to `calculators` array

**Footer** (`src/components/Footer.tsx`):
- Organized by category: Income Tax, Investment, EMI, Quick Links
- Always update footer when adding new calculators

**HomePage** (`src/components/HomeContent.tsx`):
- Grid of calculator cards with icons and descriptions
- Uses Framer Motion for animations
- Add new calculators to `calculators` array

### Layout Pattern

```
layout.tsx (html/body wrapper)
  └── AppLayout.tsx (Navbar + Main + Footer)
      └── page.tsx content
```

### Mobile Responsiveness Best Practices

**Prevent Horizontal Scroll**:
- Root: `<html className="overflow-x-hidden">`
- Body: `<body className="overflow-x-hidden">`
- AppLayout: `<div className="overflow-x-hidden">`
- Main: `<main className="w-full">`

**Tables**: Use this pattern for mobile-friendly tables:
```tsx
<div className="bg-white rounded-xl shadow-lg overflow-hidden w-full">
  <div className="overflow-x-auto -mx-4 sm:mx-0">
    <div className="inline-block min-w-full align-middle px-4 sm:px-0">
      <table className="min-w-full divide-y divide-gray-200">
        {/* table content */}
      </table>
    </div>
  </div>
</div>
```

**Dropdowns**: Constrain to viewport:
```tsx
className="absolute right-0 w-56 max-w-[calc(100vw-2rem)] z-50"
```

### Calculator Components Pattern

Most calculators follow this structure:
1. **Form Component** - Inputs with sliders/text fields
2. **Summary Component** - Results display with pie/donut charts
3. **Table Component** - Yearly breakdown
4. **Main Calculator** - Orchestrates state, URL params, calculations

Example: Step-Up SIP
- `StepUpForm.tsx` - User inputs
- `StepUpSummary.tsx` - Results visualization
- `StepUpBreakdownTable.tsx` - Yearly data table
- `StepUpSIPCalculator.tsx` - Main component

### State Management Pattern

Calculators use:
- Local state with `useState`
- URL sync with `useQueryParams` hook
- Debounced inputs with `useDebounce` hook
- Router for navigation

Example:
```typescript
const [investment, setInvestment] = useState(() =>
  getQueryParam('investment', 5000)
);
const debouncedInvestment = useDebounce(investment, 500);

useEffect(() => {
  const queryString = createQueryString({ investment: debouncedInvestment });
  router.push(`${pathname}?${queryString}`, { scroll: false });
}, [debouncedInvestment]);
```

### Calculations (`src/lib/calculations.ts`)

All business logic lives here:
- `calculateSIP()` - Regular SIP calculations
- `calculateStepUpSIP()` - Step-up SIP calculations
- `calculateEMI()` - Loan EMI calculations
- `calculateTax()` - Tax calculations
- Helper functions for defaults

### Metadata Pattern

Each page has metadata for SEO:
```typescript
// In page.tsx or metadata.ts
export const metadata: Metadata = getMetadata({
  title: 'Calculator Name',
  description: 'Description',
  keywords: ['keyword1', 'keyword2'],
  canonicalUrl: '/route',
  pageType: 'calculator',
  calculatorType: 'SIP'
});
```

## Adding a New Calculator - Checklist

1. **Create page**: `src/app/new-calculator/page.tsx`
2. **Add route**: Update `src/constants/routes.ts`
3. **Create calculator component**: `src/components/calculators/NewCalculator.tsx`
4. **Add calculations**: Update `src/lib/calculations.ts`
5. **Update navigation**:
   - `src/components/Navbar.tsx` - Add to `calculators` array
   - `src/components/HomeContent.tsx` - Add calculator card
   - `src/components/Footer.tsx` - Add to appropriate section
6. **Add metadata**: Create `metadata.ts` or add to `page.tsx`
7. **Update sitemap**: `src/app/sitemap.ts`

## Common Issues & Solutions

### Mobile Horizontal Scroll
- Check all tables use the mobile-friendly table pattern
- Ensure `overflow-x-hidden` on html, body, AppLayout
- Add `w-full` to main content area
- Use `max-w-[calc(100vw-2rem)]` for dropdowns

### Hamburger Menu Off-Screen
- Add `max-w-[calc(100vw-2rem)]` to Menu.Items
- Ensure `right-0` positioning
- Add high `z-index` (z-50)

### Build Errors
- Font loading may fail offline (Google Fonts)
- Run `npm install` if dependencies missing
- Check TypeScript types in `src/types/calculator.ts`

## Git Workflow

- Main branch: (check git status for default branch)
- Feature branches: `claude/feature-name-{sessionId}`
- Always push to branch starting with `claude/` and ending with session ID

## Analytics

Google Analytics configured in `src/app/layout.tsx`:
- GA4 ID: `G-D0QRFN4X4Z`
- Loaded with Next.js Script component

## Testing

- Build: `npm run build`
- Dev: `npm run dev`
- No automated tests currently configured

## Notes for Claude

- **Always check ROUTES constant** before hardcoding paths
- **Mobile-first**: Test responsive behavior for all new components
- **Use existing patterns**: Follow calculator component structure
- **Update all navigation**: Navbar, Footer, HomePage when adding routes
- **Commit format**: Use conventional commits (feat:, fix:, etc.)
- **Don't explore unnecessarily**: Reference this file first
